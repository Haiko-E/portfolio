---
import Layout from '../../layouts/Layout.astro';
import { useSanityClient } from 'astro-sanity';
import type { Project } from '../../ts/types/types';
import ProjectItem from '../../components/ProjectItem.astro';

export async function getStaticPaths() {
  console.log('getStaticPaths gets called');
  const query = `*[_type == "project"]{..., backgroundimage{alttext, asset->}, "tags": tags[]->name}`;
  const projects = await useSanityClient().fetch(query);
  return projects.map((project: Project) => {
    return {
      params: { slug: project.slug.current },
      props: { project },
    };
  });
}

const { project } = Astro.props;
---

<Layout title={`Project page -- ${project.title} `}>
  <ProjectItem project={project} isClickable={false} />
</Layout>
